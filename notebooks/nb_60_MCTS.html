
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MPC and AlphaZero &#8212; Machine Learning Control Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/nb_60_MCTS';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Machine Learning &amp; Control" href="nb_70_machine_learning_control.html" />
    <link rel="prev" title="Model Predictive Control" href="nb_50_MPC.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/transferlab-logo.svg" class="logo__image only-light" alt="Machine Learning Control Training - Home"/>
    <script>document.write(`<img src="../_static/transferlab-logo-dark.svg" class="logo__image only-dark" alt="Machine Learning Control Training - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook Pages</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="nb_10_introduction.html">Introduction</a></li>



<li class="toctree-l1"><a class="reference internal" href="nb_20_dynamic_programming.html">Dynamic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_30_systems.html">Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_40_LQR.html">Linear Quadratic Regulator</a></li>



<li class="toctree-l1"><a class="reference internal" href="nb_50_MPC.html">Model Predictive Control</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">MPC and AlphaZero</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_70_machine_learning_control.html">Machine Learning &amp; Control</a></li>



<li class="toctree-l1"><a class="reference internal" href="nb_80_safe_learning_control.html">Safe Learning in Robotics</a></li>

<li class="toctree-l1"><a class="reference internal" href="nb_90_practice.html">Practice</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.environments.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.environments</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.environments.grid_world.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.environments.grid_world</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.environments.utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.environments.utils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.environments.cart.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.environments.cart</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.environments.inverted_pendulum.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.environments.inverted_pendulum</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.models.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.models</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.models.models.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.models.models</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.models.sindy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.models.sindy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.models.dmd.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.models.dmd</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.nb_utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.nb_utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.shortest_path_problem.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.shortest_path_problem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.plots.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.plots</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.hyperopt.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.hyperopt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/training_ml_control/training_ml_control.control.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">training_ml_control.control</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/nb_60_MCTS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MPC and AlphaZero</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-tree-search">Monte Carlo Tree Search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_ActiveScene docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">presentation_style</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>/*
This file is mainly copy-pasta from rise's examples
https://github.com/damianavila/RISE/blob/master/examples/rise.css
that was further customized for appliedAI purposes
*/
@import url('https://fonts.googleapis.com/css2?family=Work+Sans:wght@400&display=swap');


/*
body {
    font-family: 'Work Sans', sans-serif !important;
    text-transform: initial !important;
    letter-spacing: initial !important;
    font-weight: 400 !important;
    line-height: 1.5 !important;
    text-size-adjust: 100% !important;
    ‑webkit‑text‑size‑adjust: 100% !important;
}


.reveal, div.text_cell_render, .md-slide, .sidebar-wrapper {
    font-size: 1.5rem !important;
}
*/

.navbar-default .navbar-nav > li > a {
    color: #00747b !important;
}

.filename {
    font-size: 2.4rem !important;
    color: #212529 !important;
    font-weight: 600 !important;
}

.reveal, .md-slide {
    color: white !important;
}

h1, h2 {
    color: #00747b !important;
}

h3, h4, h5, h6 {
    color: #808080 !important;
}

.reveal p, .reveal ol, .reveal dl, .reveal ul,
div.text_cell_render {
    color: #212529 !important;
}

/*copied from stackoverflow, better spacing between list items*/
li + li {
  margin-top: 0.2em;
}

body.rise-enabled .reveal ol, body.rise-enabled .reveal dl, body.rise-enabled .reveal ul {
    margin-left: 0.1em;
    margin-top: 0.2em;
}

.reveal .rendered_html h1:first-child,
.reveal .rendered_html h2:first-child,
.reveal .rendered_html h3:first-child,
.reveal .rendered_html h4:first-child,
.reveal .rendered_html h5:first-child {
    margin-top: 0.2em;
}

/*
.CodeMirror-lines, .output_text {
    font-size: 1.5rem !important;
}
*/

h1.plan, h2.plan, h3.plan {
    text-align: center;
    padding-bottom: 30px;
}

ul.plan>li>span.plan-bold {
    font-size: 110%;
    padding: 4px;
    font-weight: bold;
    background-color: #eee;
}

ul.plan>li>ul.subplan>li>span.plan-bold {
    font-weight: bold;
}

.plan-strike {
    opacity: 0.4;
/*    text-decoration: line-through; */
}

div.plan-container {
    display: grid;
    grid-template-columns: 50% 50%;
}

/*
 * this is to void xarray's html output to show the fallback textual representation
 * see also
   * xarray.md and
   * https://github.com/damianavila/RISE/issues/594
 */
.reveal pre.xr-text-repr-fallback {
    display: none;
}

#toc-header, .toc-item li {
    margin: auto !important;
    color: #808080 !important;
}

#toc, #toc-wrapper, .toc-item-num, #toc a, .toc {
    margin: auto !important;
    color: #00747b !important;
}

#toc-wrapper {
    top: auto !important;
    bottom: auto !important;
    margin-top: 2rem !important;
    color: #00747b !important;
}


#rise-header {
    margin: 10px;
    left: 5%;
}

#rise-footer {
    margin: 10px;
    right: 5%;
}

#rise-backimage {
    opacity: 0.70;
}

.reveal img {
    max-width: 100%;
}


.md-slide.title {
    position: relative;
    top: -50%;
    margin-left: 5%;
    font-size: 4em !important;
    line-height: 1.6;
}
</style></div></div>
</div>
<div class="cell tag_ActiveScene docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_ActiveScene docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">autoreload</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">training_ml_control.environments</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_grid_world_environment</span><span class="p">,</span>
    <span class="n">plot_grid_graph</span><span class="p">,</span>
    <span class="n">plot_grid_all_paths_graph</span><span class="p">,</span>
    <span class="n">simulate_environment</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">training_ml_control.nb_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">show_video</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="mpc-and-alphazero">
<h1>MPC and AlphaZero<a class="headerlink" href="#mpc-and-alphazero" title="Link to this heading">#</a></h1>
<p>AlphaZero is a computer program developed by artificial intelligence research company DeepMind to master the games of chess, shogi and go.</p>
<p>It is built from three core pieces:</p>
<ul class="simple">
<li><p>Value Function (Neural Network) to estimate the optimal cost-to-go for any given state.</p></li>
<li><p>Policy (Neural Network) to determine the action to take at a given state.</p></li>
<li><p>Monte Carlo Tree Search (MCTS) to simulate and search for the best plan.</p></li>
</ul>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/50_alphazero_online_play.png"><img alt="../_images/50_alphazero_online_play.png" src="../_images/50_alphazero_online_play.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Illustration of an on-line player such as the one used in AlphaGo,
AlphaZero, and Tesauro’s backgammon program. At a given position,
it generates a lookahead tree of multiple moves up to some depth, then runs
the off-line obtained player for some more moves, and evaluates the effect of the
remaining moves by using the position evaluator of the off-line player.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In AlphaZero, the policy and value networks are trained off-line and an approximate version of the fundamental DP algorithm of policy iteration. A separate on-line player is used to select moves, based on multistep lookahead minimization and a terminal position evaluator that was trained using experience with the off-line player.</p>
<p>This approach performs better than using the off-line policy directly because of the long lookahead minimization, which corrects for the inevitable imperfections of the neural network-trained off-line
player, and position evaluator/terminal cost approximation.</p>
<p>In model predictive control (MPC), there is no off-line training and we use the system’s model for the on-line rollout. The control interval is equivalent to the number of steps in lookahead minimization, while the prediction interval is equivalent to the total number of steps in lookahead minimization and truncated rollout.</p>
<section id="monte-carlo-tree-search">
<h2>Monte Carlo Tree Search<a class="headerlink" href="#monte-carlo-tree-search" title="Link to this heading">#</a></h2>
<p>Monte Carlo Tree Search (MCTS) is a heuristic search algorithm which uses stochastic simulations for decision processes, most notably those employed in software that plays board games. In that context MCTS is used to solve the game tree.</p>
<p>MCTS was combined with neural networks in 2016 and has been used in multiple board games like Chess, Shogi, Checkers, Backgammon, Contract Bridge, Go, Scrabble, and Clobber as well as in turn-based-strategy video games (such as Total War: Rome II’s implementation in the high level campaign AI).</p>
<p>The method especially took off due its effectiveness in computer Go and is still being used in DeepMind’s AlphaGoZero the most advanced Go AI to date.</p>
<p>MCTS consists of 4 steps that are repeated until some condition is met:</p>
<ol class="arabic simple">
<li><p><strong>Selection</strong>: The selection phase traverses the tree level by level, each time
selecting a node based on stored statistics like “number of visits”
or “total reward”. The rule by which the algorithm selects is called the tree policy.
Selection stops when a node is reached that is not fully explored yet, i.e.
not all possible moves have been expanded to new nodes yet.</p></li>
<li><p><strong>Expansion</strong>: The expansion step consists of adding one or multiple new
child nodes to the final selected node.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p><strong>Rollout</strong>: A rollout is initiated from each of these added nodes.
Depending on the mean depth of the tree, rollout is done until the end of the game or
as deep as possible before performing an evaluation. When dealing with
terminal states in games the evaluation is done based on the win condition
and usually yields 0 (loss), 0.5 (draw) or 1 (win).
In the original algorithm the rollout is performed at random, but in general
the so-called default policy can be enhanced by heuristics. For example,
in the case of AlphaGoZero the rollout step was completely replaced by a
neural network evaluation function.</p></li>
<li><p><strong>Backup</strong>: The outcome of the rollout step is backed up to the nodes involved
in the selection phase by updating their respective statistics</p></li>
</ol>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/50_monte_carlo_tree_search.svg"><img alt="../_images/50_monte_carlo_tree_search.svg" src="../_images/50_monte_carlo_tree_search.svg" width="80%" /></a>
</figure>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h2>
<div class="exercise admonition" id="grid-world-again">

<p class="admonition-title"><span class="caption-number">Exercise 6 </span> (Grid World Again)</p>
<section id="exercise-content">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">create_grid_world_environment</span><span class="p">(</span><span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulate_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">show_video</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="show_videos" style="border-spacing:0px;"><tr><td style="padding:1px;"><img width="256" height="256" style="image-rendering:auto; object-fit:cover;" src="data:image/gif;base64,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"/></td></tr></table></div></div>
</div>
<p>The task can be represented as the following undirected graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span>
<span class="n">plot_grid_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0236271f5a1d46b9b38e117eb77a9ac79911e0d64be0ab9b3fe5801e425c94de.png" src="../_images/0236271f5a1d46b9b38e117eb77a9ac79911e0d64be0ab9b3fe5801e425c94de.png" />
</div>
</div>
<p>We convert the graph to a directed graph with all possible paths from start to target that do not contain cycles</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">convert_graph_to_directed</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">plot_grid_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">G</span> <span class="o">=</span> <span class="n">convert_graph_to_directed</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plot_grid_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;convert_graph_to_directed&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We wish for the car to travel from its starting cell in red to the target cell in green. If the cost represents time and each step has the same cost then we want to find the shortest path to the goal.</p>
<ul class="simple">
<li><p>Arrows (edges) indicate the possible movements.</p></li>
<li><p>Numbers on edges indicate the cost of moving along an edge.</p></li>
</ul>
<p>Use MCTS to solve this problem and then implement the plan in the environment.</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>Hint 1</p>
<p>Determine all possible paths first.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">plot_grid_all_paths_graph(G)</span></code> for that.</p>
</div>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>Hint 2</p>
<p>Compute the optimal cost-to-go at each node.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">dict(G.nodes(data=True))</span></code> to get a dictionary that maps the nodes to their attributes
and you can use <code class="docutils literal notranslate"><span class="pre">G.start_node</span></code> and <code class="docutils literal notranslate"><span class="pre">G.target_node</span></code> to access the start and end (i.e. goal) nodes, respectively.</p>
</div>
</section>
</div>
<div class="solution admonition" id="notebooks/nb_60_MCTS-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#grid-world-again">  ( 6</a></p>
<section id="solution-content">
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your solution here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="nb_50_MPC.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model Predictive Control</p>
      </div>
    </a>
    <a class="right-next"
       href="nb_70_machine_learning_control.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Machine Learning &amp; Control</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-tree-search">Monte Carlo Tree Search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By appliedAI TransferLab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>